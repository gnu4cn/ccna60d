# 关于帧中继技术

所谓帧中继，属于一种非广播的多路访问（NBMA）技术。这意味着咱们必须处理地址解析问题，除了咱们使用点对点接口的情形外。

帧中继下的本地二层地址，称为数据链路的连接标识符（DLCI），这个地址仅在本地有效。例如，在某种中心分支的环境中，中心设备就应有个与其各个分支通信的唯一 DLCI。

当咱们检查某一思科设备上的帧中继 PVC 状态时，咱们将看到一个由 LMI 定义的，可能包含以下任一代码之一的状态代码：

- 活动（一切正常）
- 非活动（本地节点上无问题，但远端节点上可能存在问题）
- 已删除（业务提供商网络中的问题）


例如，思科设备提供了三种 LMI 类型：

- `CISCO`
- `ANSI`
- `Q.933a`


思科路由器已配置为自动尝试全部这三种 LMI 类型（以 `CISCO` LMI 开始），并会使用与业务提供商正使用的 LMI 类型匹配的类型，因此这一点在设计阶段不应过多关注。

在设计阶段需要考虑的最重要方面之一，是所用到的地址解析方法。当咱们在设计中用到了多点接口（即可终止多条二层电路的接口）时，那么咱们就需要找到某种提供三层到二层解析的方法。正如前面曾讨论过的，咱们有两个可帮助咱们实现这一目的的选项：

- 动态方式：利用反向 ARP 协议
- 静态方式：经由思科设备上的 `frame-relay map `这条静态配置命令


**注意** ：为了验证三层到二层的解析是否成功，咱们可使用 `show frame-relay map` 这一命令。


在某一多点接口上，反向 ARP 会自动发生。在添加了一个 IP 地址到配置了帧中继的接口后，这一功能便被启用。此时，一些请求会从指派到该特定接口的所有电路上，针对该接口正运行的任何受支持协议发出。

这一请求过程，可以 `no frame-relay inverse-arp` 这条命令予以禁用，但咱们绝不会设计一个将停止响应请求的网络。在设计时，反向 ARP 的响应不能被禁用，进而运行帧中继的设备，就将始终尝试协助某个经由帧中继的反向 ARP，尝试完成三层到二层解析的设备。

帧中继设计中的这种反向 ARP 行为，将通过 [前文曾讨论过的复制单播方法](./NBMA.md)，自动协助广播。在用到反向 ARP 时，广播支持默认存在。

当咱们通过使用物理接口，连接两台路由器到帧中继的云时，那么从帧中继视角看，这便意味着这两个特定接口，属于多点的接口，因为物理的帧中继接口，默认便属于多点的架构。即便两台路由器间的连接可能看似点对点的，但其属于帧中继的多点连接。

![帧中继多点实例](../images/4205.png)

**图 37.11** -- **帧中继的多点示例**


由于他们使用着多点接口，因此默认情况下这两台设备将通过使用反向 ARP，动态地处理三层到二层的解析。当咱们想要设计某种其中不会用到反向 ARP 的方案时，那么咱们可在各个设备上关闭这种的动态映射行为，并随后要配置静态的帧中继映射。


当涉及到三层到二层的解析时，点对点的配置便是理想选择，因为在使用了此类接口类型时，这一解析过程便不再发生。在配置点对点的帧中继时，咱们会用到点对点的子接口，同时这些子接口将不会像多点接口情形下那样，从 LMI 获取 DLCI 指派。


另一选项将是创建出子接口，并将他们声明为多点接口。这些接口类型，会完全物理的多点接口那样行事，因此咱们需确定要用到的解析方法，要么是反向 ARP，要么是静态的映射。这两种方法可组合使用，例如，在连接的一端部署反向 ARP，并在另一端定义一些静态的映射。


这些接口类型设置及所选的三层到二层解析方法，均只具有本地意义。这意味着咱们可在咱们的帧中继设计中，有着全部的各种变化，比如下表 37.1 中所列出的这些：

**表 37.1** —- **帧中继设计中的变化**


<table>
<tr>
<th>本地接口</th>
<th rowspan=7>被连接到</th>
<th>远端接口</th>
</tr>
<tr>
<td>主接口</td>
<td>主接口</td>
</tr>
<tr>
<td>主接口</td>
<td>多点子接口</td>
</tr>
<tr>
<td>主接口</td>
<td>点对点子接口</td>
</tr>
<tr>
<td>多点子接口</td>
<td>多点子接口</td>
</tr>
<tr>
<td>多点子接口</td>
<td>点对点子接口</td>
</tr>
<tr>
<td>点对点子接口</td>
<td>点对点子接口</td>
</tr>
</table>

部分网状的设计和配置，将最具挑战性。这意味二层电路，将不会在这种帧中继环境下，所涉及的全部端点间得以配置。

在中心-分支的环境中，各分支节点之间位于对方直接相连，而这意味着他们无法经由反向 ARP 解析对方。为了解决这些问题，咱们可执行以下任一操作：

- 提供额外的静态映射
- 配置一些点对点的接口
- 将这种中心-分支的基础设施，设计为三层路由设计可解决这种解析问题（例如，通过使用 OSPF 的点对多点网络类型）


帧中继支持可影响服务质量（QoS）的标记。例如，帧中继头部包含了一个 DE（Discard Eligible，可丢弃）位。在 QoS 的帧中继环境下，数据包可标记以这个 DE 位，而这会通知业务提供商，这些特定数据包并不很重要，而可在拥塞情形下被丢弃。这种行为将使那些没有设置这个 DE 位的数据包优先。

其他可在帧中继环境中配置的参数，分别是前向显式拥塞通知（FECN），及后向显式拥塞通知（BECN），二者常会作为考试问题出现。当帧中继设备配置了要这样做时，那么他们便可就拥塞而通知设备，进而引起发送速率减慢。


