# 适当的事件响应流程


当出现问题时，那么就要有某种响应，来确定出到底是哪里出了问题、为何其会出问题，并要使其再次正常。在调查某一安全事件时，有数项要遵循的最佳实践，以确保一次全面的调查与恢复。一些基本的取证流程与快速行动，有助于防止 “煤矿中的金丝雀” 演变为灾难性后果。这一小节将涵盖以下主题：

- 基本的取证流程
- 损害与损失控制
- 监管链
- 事件响应：第一响应人


> *译注*：所谓 canary in a coalmine，煤矿里的金丝雀，是指危险的早期信号。这里大概相当于我们所说的，小洞不补大洞尺五，或千里之堤溃于蚁穴。
>
> 参考：[礦坑工人與金絲雀：一種聲音關係美學](https://www.heath.tw/nml-article/the-coal-mine-and-the-canaries-an-aesthetics-of-sound-relationship/)


## 基本的取证流程


在收集信息以分析一次安全响应时，有着数项要实施的注意事项及最佳实践，以所有可用信息都能得以收集。以下是一些基本的取证流程：

**易失性排序** —— 在某一安全事件后收集信息时，要以易失性从高到低的顺序收集，即以信息被篡改或丢失可能性的顺序。那些最易失的信息保存于 RAM 中，且其正不断变化。接着，可能会有一些定期变化的信息，比如交换文件或一些系统进程的工作文件。较不易失的数据，便属于磁盘内容。其为不太可能被更改的数据，而因此最不易失，并会保存在一些单独的系统上，比如日志记录或归档的数据。

在收集数据时，立即关闭某个受影响系统，未必是个好主意，因为这样做会导致那些最易失信息的丢失。在可行时，在采取将导致易失数据丢失的操作前，这些信息应加以收集；

**捕获系统镜像** —— 为了针对取证调查而保留某一系统中的非易失性内容，标准做法是要创建一个系统镜像。这一镜像属于某一磁盘或阵列内容的一个及时快照。在创建镜像时，建议要创建该镜像的一个比如 MD5 或 SHA512 的哈希值，确保进一步的数据完整性。文件的哈希值，可与从任何该文件今后副本新生成的哈希值比对，确保没有已对该文件进行的更改。

制作磁盘、分区或阵列的映像，都是可行的。制作条带化独立磁盘冗余阵列（RAID）中某单个磁盘的镜像，将无法生成一个可用镜像。请注意，咱们要创建的镜像类型，要符合需要捕获的数据类型。



**网络流量与日志** —— 事件调查可通过分析持续捕获并记录的数据，而得以极大助力。由于网络通信本质上是瞬态的，因此只有在流量已被捕获下，流量分析才能开展。为了能够分析流量，咱们必须提前配置可能有用的日志记录。针对任何瞬时事件也都可以这样说。由于难以预判哪些信息可能有用，因此应尽力在监控开销与追踪深度之间寻求平衡；

**录制视频** —— 任何相关的视频，均应得以录制及保存。这些视频可作为所发生事件的可靠记录在随后加以查证，而非仅依赖记忆；

**记录时间偏移** —— 同一网络上的系统，在其系统时钟时间方面有着细微差异并不罕见。在比对不同来源的日志记录时，了解事件发生的顺序可能至关重要。要记下某一给定系统时钟，与某一可信基准的时间偏差；

**取得哈希值** —— 哈希值确保了数据的完整性。某一改变后的文件哈希值，正是该文件的内容，不在与哈希值被创建时内容一样的指标。对任要创建并记录那些数据完整性重要的全部文件哈希值；

**屏幕截图** —— 除了视频外，一些在进行工作的截图也可予以创建，以帮助形成某一系统在任何给定时间的状态；

**目击者** —— 就像 RAM 中内容一样，第一手记忆属于易失的。要在事件发生后立即从人员收集信息，因记忆不会随时间推移保持不变；

**追踪工时与开支** —— 跟踪响应某一事件的成本，在确定这一响应是否与风险相称，并响应地调整优先级方面会很有用。要记录响应某一事件所花的时间，及在给定时间内完成的工作。除了那些已经采取的步骤，与尚需采取的步骤外，有着对哪些工作已于何时完成的一个记录，在确定某次响应总成本方面，会很有价值。


## 损害与损失控制

在应对某一事件时的一个主要目标，便是最小化这一事件的严重程度，也称为损害与损失控制。这种控制属于必须经常与诸如确保系统完整性等，其他重要事项权衡的一项重要考量。对于一些事件，在我们开始察觉到某种问题时，威胁便已然消散；而在别的一些时候，某一事件则可能代表着一项持续威胁，比如某一病毒或某一特洛伊木马感染的系统等。在响应某一进行中的事件时，必须迅速采取一些步骤，防止尚未发生的损害与损失；

## 监管链

曾经手或曾访问过出于取证目的而收集的信息的人员名单，称为监管链。其目的是提供有关谁经手过这些证据的档案，并要能够随时说明证据的下落；

## 事件响应：第一响应人

作为某一事件的第一响应人，咱们可能需要根据一些不完整信息作出决策。咱们将需要权衡一些相互竞争的考量，比如所收集的取证数据完整性，与某一受影响系统可能构成的持续威胁。这种情况可能意味着快速地将这一事件，分类为已过去或正在进行，并其为一项正在进行的威胁情形下立即采取行动。首要任务是在最大限度保留证据（最小的损坏证据）的同时，尽可能限制破坏。应制订一项明确了某一事件第一响应人，应采用的流程的政策，比如何种情形下，会构成某一需要升级至响应团队的事件。

