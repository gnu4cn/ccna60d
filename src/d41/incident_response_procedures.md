# 适当的事件响应流程


当出现问题时，那么就要有某种响应，来确定出到底是哪里出了问题、为何其会出问题，并要使其再次正常。在调查某一安全事件时，有数项要遵循的最佳实践，以确保一次全面的调查与恢复。一些基本的取证流程与快速行动，有助于防止 “煤矿中的金丝雀” 演变为灾难性后果。这一小节将涵盖以下主题：

- 基本的取证流程
- 损害与损失控制
- 监管链
- 事件响应：第一响应人


> *译注*：所谓 canary in a coalmine，煤矿里的金丝雀，是指危险的早期信号。这里大概相当于我们所说的，小洞不补打洞尺五，或千里之堤溃于蚁穴。
>
> 参考：[礦坑工人與金絲雀：一種聲音關係美學](https://www.heath.tw/nml-article/the-coal-mine-and-the-canaries-an-aesthetics-of-sound-relationship/)


## 基本的取证流程


在收集信息以分析一次安全响应时，有着数项要实施的注意事项及最佳实践，以所有可用信息都能得以收集。以下是一些基本的取证流程：

**易失性排序** —— 在某一安全事件后收集信息时，要以易失性从高到低的顺序收集，即以信息被篡改或丢失可能性的顺序。那些最易失的信息保存于 RAM 中，且其正不断变化。接着，可能会有一些定期变化的信息，比如交换文件或一些系统进程的工作文件。较不易失的数据，便属于磁盘内容。其为不太可能被更改的数据，而因此最不易失，并会保存在一些单独的系统上，比如日志记录或归档的数据。

在收集数据时，立即关闭某个受影响系统，未必是个好主意，因为这样做会导致那些最易失信息的丢失。在可行时，在采取将导致易失数据丢失的操作前，这些信息应加以收集；

**捕获系统镜像** —— 为了针对取证调查而保留某一系统中的非易失性内容，标准做法是要创建一个系统镜像。这一镜像属于某一磁盘或阵列内容的一个及时快照。在创建镜像时，建议要创建该镜像的一个比如 MD5 或 SHA512 的哈希值，确保进一步的数据完整性。文件的哈希值，可与从任何该文件今后副本新生成的哈希值比对，确保没有已对该文件进行的更改。

制作磁盘、分区或阵列的映像，都是可行的。制作条带化独立磁盘冗余阵列（RAID）中某单个磁盘的镜像，将无法生成一个可用镜像。请注意，咱们要创建的镜像类型，要符合需要捕获的数据类型。


---


**网络流量与日志** —— 通过分析持续捕获并记录的数据，可极大助力事件调查工作。 由于网络通信具有瞬时特性，只有预先捕获流量才能进行流量分析。为实现流量分析，必须预先配置可能有用的日志记录。任何瞬时事件均遵循此原则。由于难以预判哪些信息可能有用，应努力在监控开销与追踪深度之间寻求平衡。
录制视频——所有相关视频均应录制并保存。这些视频可作为事件的可靠记录供后续查证，而非仅依赖记忆。记录时间偏移——同一网络中不同系统的系统时钟存在细微时间差异实属常见。在比对不同来源的日志时，事件发生的顺序可能至关重要。请记录特定系统时钟相对于可信基准的时间偏差。
生成哈希值——哈希值可确保数据完整性。文件哈希值的改变表明文件内容已与生成哈希值时不符。对任何需要保障数据完整性的文件，均应生成并记录其哈希值。
屏幕截图——除视频外，还可截取工作过程中的屏幕画面，以记录系统在特定时刻的状态。目击证词——如同内存内容，第一手记忆具有易失性。应在事件发生后尽快收集人员信息，因记忆会随时间流逝而改变。
追踪工时与开支——记录事件响应成本有助于判断响应措施是否与风险相称，并据此调整优先级。需记录事件响应所耗时间及特定时段内完成的工作内容。除已采取措施与待执行步骤外，完整的工作时间线记录对核算响应总成本具有重要价值。

