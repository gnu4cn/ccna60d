# 基本的 QoS 概念

QoS 背后的原理相当简单。由于业务的决策，或因为诸如视频会议或网络电话（VoIP）等流量类型不能很好的容忍延迟，因此咱们网络中某些流量类型，就应相比其他流量类型，给予更高优先级。现代网络支持通过单一传输基础设施的数据、语音和视频等流量，而因此出于这一原因，这些网络被称为融合网络。但是，要配置咱们的设备以充分利用这些流量类型，仍取决于作为网络管理员的咱们自己。

QoS 可让咱们管理有限带宽，从而咱们可充分利用先有带宽，并提供可预测性能。他不是设计不良、过时或配置不当网络的解决方案，因此在应用 QoS 前，要确保咱们已解决了布线问题、由于低规格路由器导致的高 CPU 使用率、过大的路由表、IOS bug 及其他网络问题。QoS 默认是禁用的（见下文）。咱们通常将必须采访那些关键业务所有者，确定哪些流量得到优先。

尽管一些带宽密集型应用会挤压网络能力与资源，但他们同时会补充、增值并增强每项业务流程。

融合网络必须提供安全、可预测、可测量，且在有时有保证的服务。为确保那些成功的端到端业务解决方案，QoS 便是管理网络资源所必需的。多数网络会遇到以下问题：

- 延迟问题
- 带宽问题
- 抖动问题
- 数据包丢失问题


网络中所有数据包，都会遇到某种自数据包最先发送，到其到达其预期目的时的某种延迟。这种从开始到完成的总延迟，称为时延。数据包或数据帧，都会遇到数种延迟类型。虽然深入探讨每种延迟的具体情况超出 CCNA 考试要求范围，但延迟的一些常见原因包括以下这些：

- 串行化的延迟：在线路上逐位发送比特位所需的时间
- 排队的延迟：数据包等待其他数据包发送时经历的延迟
- 转发的延迟：数据包已被置于输出队列中后，数据帧被发送的处理时间

通常而言，所谓带宽，是指在某种介质上预期会成功投送的每秒比特数（bps）。基于这一定义，带宽便等同于物理链路的速率，或接口的时钟频率。但在交换的术语下，带宽一词指的是交换机结构的容量。因此，WAN 连接的带宽考量，与 LAN 连接未必相同。

所谓抖动，是连续数据包间的延迟变化。抖动通常称为变化延迟。虽然这种变化对于应用及数据流量尚可接受，但他们会严重影响那些同步流量，比如数字语音等，这种流量要求数据包以一种一致、同一的方式传输。

数据包丢失会于通过网络的一个或多个数据包，未能到达其预期目的地时发生。这会因诸如比特位错误，或队列空间不足等多种情况发生。虽然这一般不会影响那些诸如 TCP 等面向连接的协议，但数据包丢失会造成一些诸如语音及流媒体视频等实时流量的重大问题。

重要的是要清楚，在默认模式下，包括诸如语音等实时流量的所有流量，均将要以一种尽力而为的方式投送，并且所有流量都将使用交换机上的单个队列。不同队列将在这一章稍后介绍。这一默认行为，通过使用 `show mls gos` 这条命令得以验证，如下输出中所示：


```console
Switch#show mls qos int g0/1
GigabitEthernet0/1
QoS is disabled. pass-through mode
...

[Output Truncated]
```


咱们也可以全局启用他。一旦得以启用，`show mis gos` 这条命令便可用于验证这一配置。一旦 QoS 启用后，这一配置的输出如下所示：

```console
Switch#show mls qos
QoS is disabled
Switch#conf t
Switch(config)#mls qos
Switch(config)#end
Switch#show mls qos
QoS is enabled
QoS ip packet dscp rewrite is enabled
```


请注意，这些命令在 Packet Tracer 上将不工作，且一些型号将直接移除 `Qos is disabled` 的输出，表明现在其于运行中。


## 流量类型


网络流量可分为三种主要类型：

- 语音
- 视频
- 数据

语音流量会以固定数据速率，产生一些数据流。这些流属于一些同步流（即数据包会在同一时间，或以相等间隔时间到达）。同步流量不会很到地容忍延迟，从而导致通话卡顿或通话完全丢失。

视频流量可以是诸如视频会议等交互式的，以及诸如流媒体观看等非交互式的。其数据包大小虽各不相同，但都会受丢包或延迟影响。

数据流量一般会很好地容忍延迟/丢包。多数应用都会简单地自动重新发送丢失的数据包。在这种情况下应用 QoS 收效不大。


