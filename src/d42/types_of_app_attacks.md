# 应用攻击的类型

攻击可以基础设施、用户或应用为目标。在这一小节中，我们将重点探讨那些面向用户的应用及 web 主机，可能有的不同漏洞类型，以及针对这些服务，在应用级别可能实施的攻击类型。这一小节将涵盖以下主题：

- 跨站脚本（XSS）
- SQL 注入
- LDAP 注入
- XML 注入
- 目录遍历/命令注入
- 缓冲区溢出
- 零日漏洞
- Cookie 与附件
- 恶意附加组件
- 会话劫持
- 头部篡改


## 跨站脚本攻击（XSS）

所谓跨站脚本攻击（或 Cross-site Scripting, XSS，以区别于层叠样式表 CSS），是针对某种 web 浏览器攻击的最常见攻击类型之一。在一次 XSS 攻击中，未授权的脚本代码会被客户端浏览器执行，而这就会将用户信息，暴露到某一未授权的第三方站点。

这段脚本代码可能并非来自该站点本身，而是来自允许来自第三方的代码，被客户端浏览器执行的某一站点漏洞。来自某一不相关站点的代码很常见，这正是这一攻击类型被称为跨站脚本攻击的原因。攻击代码还可能来自诱使用户点击的链接、服务器端脚本的未授权编辑、到托管于其他站点脚本的链接，甚至设计利用一些特定浏览器，比如某种渲染 HTML 代码的电邮浏览器的一些专门构思的 “图像” 链接。

大多数浏览器都被设计为阻止站点与别的站点通信，但黑客们一直在努力绕过这些安全特性。一次成功的 XSS 攻击，便能绕过这些防护机制，泄露用户名、密码、会话 ID 或其他机密信息。

为防范 XSS 攻击，管理员应将 web 表单中的所有代码，均作为潜在恶意代码处理，验证这些代码以确保其未包含未授权代码，比如指向恶意脚本而非图片的那些图像链接。


## SQL 注入

另一种可针对托管应用使用的攻击类型，便是 SQL 注入攻击。当某名攻击者能够输入会被某种 SQL 服务器，解析为 SQL 命令的信息时，这种攻击便会发生。例如，当某个表单允许用户输入会被发送到某一 SQL 数据库的信息，且仅有薄弱验证时，那么攻击者便能够指示 SQL 数据库删除某个数据表，或创建一次泄露私密数据的查询，而不仅是插入新数据。

防止 SQL 注入攻击的输入验证，会采取许多形式，而一些基本步骤，则是要确保用户输入被作为文本字符串，而不是代码对待，并要限制输入为一些特定字符集。某个字符集限制的名字字段，就会不允许数字与特殊字符，例如等号、括号或标点符号等。

## LDAP 注入

所谓轻量级目录访问协议（LDAP）注入攻击，与 SQL 注入攻击的原理相似。主要区别在于攻击的目标。攻击者现在不是寻求注入可执行 SQL 代码到某个 web 表单，而是尝试执行 LDAP 的代码。

就如 SQL 注入下一样，针对 LDAP 注入的最佳防护，是通过验证输入并确保所有用户输入均被存储为字符串，而非作为可执行代码解析。

## XML 注入


可扩展标记语言（XML）的注入，有着与 LDAP 及 SQL 注入的很多共通点。与其他代码注入攻击类型一样，一次 XML 注入攻击的目标，就是要在标准用户输入处插入可执行代码，不过是使用 XML。

## 目录遍历/命令注入

要考虑的代码注入最后一种形式，是目录遍历或命令注入攻击。在这种攻击下，某名攻击者可能发送一些会被文件 API 解析的特殊字符。例如，用户会请求某个域中的一个 web 页面，这个页面通常是存储于某一服务器上，一个特定目录下某个文件的文件名，如 `/var/www/html/index.htm`。该用户通常将前往 `example.com/index.htm`，以查看这个文件/web 页面。但是，某名攻击者则可能会尝试前往 `example.com/../../../../../etc/passwd`，或任何可能包含了该攻击者感兴趣文件的另一位置。


或者，某名攻击者可能输入一些文件系统命令，到一些 web 表单中，以期糟糕的后端设计将放行文件 API 尝试执行这一命令。例如，某名用户便可能将他/她的名字，输入为 `"test; rm rf /etc/passwd"`。这些攻击依赖于传递会被文件系统 API 解析的信息到 web 服务器。

与我们已探讨过的别的注入攻击一样，最佳防护措施便是验证输入内容，并将用户输入显式地作为字符串，而非可解析代码处理。


## 缓冲区溢出

所谓缓冲区溢出，攻击是指发送至内存区域的数据量超过该区域分配的存储容量。 在精心设计的缓冲区溢出攻击中，攻击者可能执行任意代码。此类攻击通常比我们讨论过的其他攻击更为复杂，因为它们在计算层次结构的更底层运行。一旦攻击者能够修改内存堆栈中的指令，往往就能获得对机器的完全控制权。
缓冲区溢出攻击极难防御，但通过严谨的内存管理技术可有效预防或减轻其危害。诸如微软数据执行保护（DEP）等工具，旨在削弱攻击者将缓冲区溢出转化为系统根权控制的手段。零日攻击 零日攻击指尚未被公众知晓的漏洞利用攻击。 任何利用未公开漏洞的攻击（无论采用何种手段）均属零日攻击。由于这些漏洞无法预先知晓，若启用了攻击目标服务则无从防御。最佳实践是禁用所有非必要服务以缩小攻击面。零日攻击无法利用未启用的软件漏洞。
Cookie与附件Cookie是浏览器存储在本地硬盘上的信息片段。这些Cookie可能包含对攻击者具有价值的个人信息，例如用户的浏览习惯，甚至持久性会话ID。若攻击者获取会话ID，便可能劫持会话，实现对用户的有效冒充。
