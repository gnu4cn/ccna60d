# DHCP 问题的故障排除


与 NAT 一样，DHCP 的问题几乎总是由于配置中的某种错误造成（戏称为八层问题，意思是有人搞砸了）。


`service dhcp` 这条命令默认是打开的，但有时他会被某名网络管理员，出于某种原因手动禁用。(我（作者）就曾见过，有网络管理员在路由器上输入 `no ip routing` 命令后，以他们网络上的紧急路由问题打电话给 Cisco -- 真的！）。

当咱们正使用位于另一子网的服务器管理 DHCP 配置时，那么 DHCP 数据包就需要在咱们路由器上放行。DHCP 使用广播报文作为其过程的一部分（路由器不会转发这些报文），因此 DHCP 服务器的 IP 地址就需要被添加到路由器上，允许其作为单播数据包转发广播报文。命令 `ip helper-address [ip address]` 实现了这一目的。这是另一个考试常考的问题！他们在考试大纲中将其称为 DHCP 中继。

作为咱们故障排除过程的一部分中，咱们同样可以使用以下这些 `debug` 命令：

```console
debug ip dhcp server events
debug ip dhcp server packet
```
请确保咱们要敲入所有这些命令到某个路由器上。在地球上，咱们不可能仅仅通过纸上阅读，就能记住他们。要尝试配置、犯错、提出问题、故意弄坏（不是某个真实网络上），并再次修复。

-- 正所谓：纸上得来终觉浅，绝知此事要躬行

