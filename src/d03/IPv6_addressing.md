# IPv6 分址

我们已经知道，IPv6 使用了 128 位的地址。由于地址格式不同于我们都已习惯的 IPv4 地址格式，乍一看往往会让人感到困惑。不过，一旦掌握了，那么其中逻辑和结构就非常简单。128 位的 IPv6 地址，用到十六进制值（即数字 0 至 9 及字母 A 至 F）。而在 IPv4 中，子网掩码可以 CIDR 表示法（如 `/16` 或 `/32`），或点分十进制表示法（如 `255.255.0.0` 或 `255.255.255.255`），而由于 IPv6 地址长度的原因，IPv6 的子网掩码只以 CIDR 表示法表示。全局的 128 位 IPv6 地址，分为以下三部分：

- 运营商分配的前缀
- 站点前缀
- 接口或主机的 ID

提供商分配的前缀，也称为全局地址空间，是个分为以下三个不同部分的 48 位前缀：

- 16 位的保留 IPv6 全局前缀
- 16 位的运营商持有前缀
- 16 位的运营商分配前缀

所谓 IPv6 的全局前缀，用于表示 IPv6 的全局地址空间。全部 IPv6 的全球互联网地址，都位于 `2000::/16` 到 `3FFF::/16` 的范围内。而 16 位的运营商持有 IPv6 前缀，属于分配给运营商并由提供商持有的。这些前缀的分配，遵循了与 IPv4 下前缀分配相同的规则。运营商持有的前缀，位于 `0000::/32` 到 `FFFF::/32` 范围内。

接下来的 16 位，表示由具体运营商，从提供商分配的前缀地址空间，分配给某个组织的 IPv6 前缀。这个前缀位于 `0000::/48` 到 `FFFF::/48` 范围内。总的来说，这前 48 位，被称为运营商分配的前缀，如下图 3.1 所示。


![`48`位服务提供商分配的 IPv6 前缀](../images/0701.png)

**图 3.1** -- **48 位运营商分配的 IPv6 前缀**


所谓站点前缀，是 48 位运营商分配前缀后接下来的 16 位。站点前缀的子网掩码长度为 `/64`，其包括了 48 位运营商分配的前缀。这一前缀长度，又允许每个站点前缀包含 264 个地址。下图 3.2 展示了这个 16 位的站点前缀。


![`16`位的 IPv6 站点前缀](../images/0702.png)

**图 3.2** -- **16 位的 IPv6 站点前缀**

站点前缀之后，接下来的 64 位用于接口或主机的寻址。IPv6 地址的接口或主机 ID 部分，表示 IPv6 子网上的网络设备或主机。关于确定接口或主机地址的不同方式，将在这个课程模组稍后详细介绍。下图 3.3 展示了这些 IPv6 前缀的分配方式。


![IPv6 前缀的分配](../images/0703.png)

**图 3.3** -- **分配 IPv6 的那些前缀**

参考图 3.3，一旦客户已由 ISP 分配了 `/48` 的前缀，那么他们可在运营商分配的 48 位前缀内，自由分配和使用任何站点前缀，以及主机或接口地址。可用地址空间的巨大数量，使得任何一家企业客户，都不可能需要超过一个运营商分配的前缀，同时还允许为企业网络内的所有设备，都分配一个唯一 IPv6 全球地址。因此，对于 IPv6，NAT 将永不需要了。


